jQuery(document).ready(function(f){var e=f(".cd-horizontal-timeline"),v=150;function c(e,t,n){var i=p(e.eventsWrapper),a=Number(e.timelineWrapper.css("width").replace("px",""));"next"==n?o(e,i-a+v,a-t):o(e,i+a-v)}function m(e,t,n){var i=e.eventsContent.find(".selected");if(0<("next"==n?i.next():i.prev()).length){var a=e.eventsWrapper.find(".selected"),r="next"==n?a.parent("li").next("li").children("a"):a.parent("li").prev("li").children("a");g(r,e.fillingLine,t),h(r,e.eventsContent),r.addClass("selected"),a.removeClass("selected"),w(r),u(n,r,e)}}function u(e,t,n){var i=window.getComputedStyle(t.get(0),null),a=Number(i.getPropertyValue("left").replace("px","")),r=Number(n.timelineWrapper.css("width").replace("px","")),l=Number(n.eventsWrapper.css("width").replace("px","")),s=p(n.eventsWrapper);("next"==e&&r-s<a||"prev"==e&&a<-s)&&o(n,r/2-a,r-l)}function o(e,t,n){t=0<t?0:t,s(e.eventsWrapper.get(0),"translateX",(t=void 0!==n&&t<n?n:t)+"px"),0==t?e.timelineNavigation.find(".prev").addClass("inactive"):e.timelineNavigation.find(".prev").removeClass("inactive"),t==n?e.timelineNavigation.find(".next").addClass("inactive"):e.timelineNavigation.find(".next").removeClass("inactive")}function g(e,t,n){var i=window.getComputedStyle(e.get(0),null),a=i.getPropertyValue("left"),r=i.getPropertyValue("width"),l=(a=Number(a.replace("px",""))+Number(r.replace("px",""))/2)/n;s(t.get(0),"scaleX",l)}function h(e,t){var n=e.data("date"),i=t.find(".selected"),a=t.find('[data-date="'+n+'"]');a.height();if(a.index()>i.index())var r="selected enter-right",l="leave-left";else r="selected enter-left",l="leave-right";a.attr("class",r),i.attr("class",l).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){i.removeClass("leave-right leave-left"),a.removeClass("enter-left enter-right")})}function w(e){e.parent("li").prevAll("li").children("a").addClass("older-event").end().end().nextAll("li").children("a").removeClass("older-event")}function p(e){var t=window.getComputedStyle(e.get(0),null);if(0<=(n=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform")).indexOf("("))var n,i=(n=(n=(n=n.split("(")[1]).split(")")[0]).split(","))[4];else i=0;return Number(i)}function s(e,t,n){e.style["-webkit-transform"]=t+"("+n+")",e.style["-moz-transform"]=t+"("+n+")",e.style["-ms-transform"]=t+"("+n+")",e.style["-o-transform"]=t+"("+n+")",e.style.transform=t+"("+n+")"}function x(e,t){return Math.round(t-e)}function y(e){for(var t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,a=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+a>window.pageYOffset&&n+i>window.pageXOffset}function C(){return window.getComputedStyle(document.querySelector(".cd-horizontal-timeline"),"::before").getPropertyValue("content").replace(/'/g,"").replace(/"/g,"")}0<e.length&&e.each(function(){var e,a,t=f(this),n={};n.timelineWrapper=t.find(".events-wrapper"),n.eventsWrapper=n.timelineWrapper.children(".events"),n.fillingLine=n.eventsWrapper.children(".filling-line"),n.timelineEvents=n.eventsWrapper.find("a"),n.timelineDates=(e=n.timelineEvents,a=[],e.each(function(){var e=f(this).data("date").split("T");if(1<e.length)var t=e[0].split("/"),n=e[1].split(":");else n=0<=e[0].indexOf(":")?(t=["2000","0","0"],e[0].split(":")):(t=e[0].split("/"),["0","0"]);var i=new Date(t[2],t[1]-1,t[0],n[0],n[1]);a.push(i)}),a),n.eventsMinLapse=function(e){var t=[];for(i=1;i<e.length;i++){var n=x(e[i-1],e[i]);t.push(n)}return Math.min.apply(null,t)}(n.timelineDates),n.timelineNavigation=t.find(".cd-timeline-navigation"),n.eventsContent=t.children(".events-content"),function(e,t){for(i=0;i<e.timelineDates.length;i++){var n=e.timelineDates.length,a=x(e.timelineDates[0],e.timelineDates[i]),r=Math.round(a/e.eventsMinLapse)+1;console.log(e.timelineDates[i]+" "+80/n*r),e.timelineEvents.eq(i).css("left",80/n*r+"%")}}(n);var r,l,s,o,p,d=(l=v,s=x((r=n).timelineDates[0],r.timelineDates[r.timelineDates.length-1])/r.eventsMinLapse,s=Math.round(s)+4,o=f(".cd-horizontal-timeline .events-wrapper").width(),p=r.timelineDates.length,o<v*p?(f(".cd-timeline-navigation").show(),o=s*l):f(".cd-timeline-navigation").hide(),r.eventsWrapper.css("width",o+"px"),g(r.eventsWrapper.find("a.selected"),r.fillingLine,o),u("next",r.eventsWrapper.find("a.selected"),r),o);t.addClass("loaded"),n.timelineNavigation.on("click",".next",function(e){e.preventDefault(),c(n,d,"next")}),n.timelineNavigation.on("click",".prev",function(e){e.preventDefault(),c(n,d,"prev")}),n.eventsWrapper.on("click","a",function(e){e.preventDefault(),n.timelineEvents.removeClass("selected"),f(this).addClass("selected"),w(f(this)),g(f(this),n.fillingLine,d),h(f(this),n.eventsContent)}),n.eventsContent.on("swipeleft",function(){var e=C();"mobile"==e&&m(n,d,"next")}),n.eventsContent.on("swiperight",function(){var e=C();"mobile"==e&&m(n,d,"prev")}),f(document).keyup(function(e){"37"==e.which&&y(t.get(0))?m(n,d,"prev"):"39"==e.which&&y(t.get(0))&&m(n,d,"next")})})});